# è™šæ‹Ÿæ»šåŠ¨åˆ—è¡¨ç»„ä»¶

## å…ƒç´ é«˜åº¦ç›¸ç­‰çš„å…ƒç´ çš„è™šæ‹Ÿæ»šåŠ¨ç»„ä»¶

### å¼€å‘èƒŒæ™¯

- æµ‹è¯•é‚£è¾¹è¦æµ‹ 5000-10000 æ¡çš„æ•°æ®,ä¸”ä¸€äº›åˆ—è¡¨ä¸åƒè¡¨æ ¼çš„æœ‰åˆ†é¡µå™¨è€Œæ˜¯æ»šåŠ¨å±•ç¤ºï¼Œæ•°æ®é‡è¿‡å¤§ä¼šå¯¼è‡´DOMè¿‡å¤šæµè§ˆå™¨å¡é¡¿ğŸ˜¢ã€‚
- åŒæ—¶è¿™ä¸ªä¹Ÿæ˜¯é¢è¯•ä¸­äººå®¶æœ€çˆ±é—®çš„é—®é¢˜ä¹‹ä¸€ï¼Œåç«¯ä¸€ä¸‹ä¼ ç»™ä½ 10wæ¡æ•°æ®ä½ è¯¥æ€ä¹ˆå±•ç¤ºğŸ˜‚ã€‚

### å¼€å‘æ€è·¯

- é¦–å…ˆè¿›è¡Œè°ƒç ”å®ç°çš„åŸºæœ¬æ–¹å¼,åŸºæœ¬å¤§å·®ä¸å·®ã€‚åŸºäºä¸€ä¸ªçª—å£ç›’å­å’Œä¸€ä¸ªæ’‘å¼€æ»šåŠ¨é«˜åº¦çš„ç›’å­ç»„æˆåŸºæœ¬çš„å®¹å™¨ï¼Œå‰©ä¸‹çš„é‡Œé¢çš„å…ƒç´ æ ¹æ®æ»šåŠ¨çš„é«˜åº¦æ¥è®¡ç®—ä¸€ä¸ªè¦å±•ç¤ºçš„å…ƒç´ ç´¢å¼•èŒƒå›´è¿›è¡Œç»å¯¹å®šä½å³å¯ã€‚
- ç»è¿‡ä¸Šé¢çš„åˆ†æï¼Œéœ€è¦è™šæ‹Ÿæ»šåŠ¨çš„å…ƒç´ æ˜¯å¤–éƒ¨æ§åˆ¶çš„ï¼Œè€Œè¿™äº›å¤–éƒ¨çš„å…ƒç´ æ˜¯åªéœ€è¿›è¡Œå¯¹å®¹å™¨çš„ç»å¯¹å®šä½å³å¯ã€‚å› æ­¤ç»„ä»¶å¯ä»¥å®šä½ä¸ºä¸€ä¸ªç»´æŠ¤è™šæ‹Ÿæ»šåŠ¨æ•°æ®å’Œæ ·å¼çš„å®¹å™¨å³å¯ï¼Œå†é€šè¿‡ vue çš„ä½œç”¨åŸŸæ’æ§½å®ç°å¯¹å¤–éƒ¨å…ƒç´ çš„ä¼ å‚å³å¯ã€‚

### å®ç°ä»£ç 

- lb-scroll ç»„ä»¶

```vue
<template>
	<!-- è™šæ‹Ÿæ»šåŠ¨ç»„ä»¶ï¼ˆåªé€‚åˆé«˜åº¦ç›¸ç­‰çš„å…ƒç´ ï¼‰ -->
	<div class="lb-scroll-box" ref="lbScrollBoxRef" @scroll="handleScroll">
		<div class="lb-scroll-box_content" :style="contentHeight">
			<slot :renderList="renderList"></slot>
		</div>
	</div>
</template>

<script>
export default {
	props: {
		// è™šæ‹Ÿæ»šåŠ¨çš„å…ƒç´ ä¸ªæ•°
		itemCount: {
			type: Number,
			default: 100,
		},
		// è™šæ‹Ÿæ»šåŠ¨çš„å…ƒç´ çš„é«˜åº¦
		itemSize: {
			type: Number,
			default: 100,
		},
		// ä¸Šç¼“å†²åŒºçš„å…ƒç´ ä¸ªæ•°
		startCacheCount: {
			type: Number,
			default: 2,
		},
		// ä¸‹ç¼“å†²åŒºçš„å…ƒç´ ä¸ªæ•°
		endCacheCount: {
			type: Number,
			default: 2,
		},
	},
	data() {
		return {
			scrollOffset: 0, //è®°å½•æ»šåŠ¨æ¡æ»šåŠ¨çš„è·ç¦»
			height: 0, //æ’‘å¼€æ»šåŠ¨æ¡çš„é«˜åº¦
		};
	},
	computed: {
		contentHeight() {
			return `height:${this.itemCount * this.itemSize}px`;
		},
		renderList() {
			// å¯è§†åŒºèµ·å§‹ç´¢å¼•
			const startIndex = Math.floor(this.scrollOffset / this.itemSize);
			// ä¸Šç¼“å†²åŒºèµ·å§‹ç´¢å¼•
			const finialStartIndex = Math.max(0, startIndex - this.startCacheCount);
			// å¯è§†åŒºèƒ½å±•ç¤ºçš„å…ƒç´ çš„æœ€å¤§ä¸ªæ•°
			const numVisible = Math.ceil(this.height / this.itemSize);
			// ä¸‹ç¼“å†²åŒºç»“æŸç´¢å¼•
			const endIndex = Math.min(this.itemCount - 1, startIndex + numVisible + this.endCacheCount);
			const items = [];
			// æ ¹æ®ä¸Šé¢è®¡ç®—çš„ç´¢å¼•å€¼ï¼Œä¸æ–­æ·»åŠ å…ƒç´ ç»™container
			for (let i = finialStartIndex; i <= endIndex; i++) {
				const itemStyle = {
					style: {
						position: 'absolute',
						top: this.itemSize * i + 'px', // è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨containerä¸­çš„topå€¼
						height: this.itemSize + 'px',
						width: '100%',
						zIndex: 0,
					},
					index: i,
				};
				items.push(itemStyle);
			}
			return items;
		},
	},
	methods: {
		handleScroll(e) {
			this.scrollOffset = e.target.scrollTop;
		},
	},
	mounted() {
		this.$nextTick(() => {
			this.height = this.$refs.lbScrollBoxRef.offsetHeight;
		});
	},
};
</script>

<style lang="less" scoped>
.lb-scroll-box {
	height: 100%;
	overflow-y: auto;
	position: relative;
}
</style>
```

- è°ƒç”¨çš„ä¸šåŠ¡é¡µé¢ä»£ç 

```vue
<template>
	<lb-scroll v-if="dataList.length" :itemSize="25" :itemCount="dataList.length + 1">
		<template v-slot="{ renderList }">
			<div v-for="(item, index) in renderList" :key="index" :class="['provider-item', item.index === clickIndex ? 'is-active' : '']" :style="item.style" @click="handleClick(item.index)">
				<template v-if="dataList[item.index]">
					<span class="provider-name">{{ dataList[item.index].name }}</span>
					<el-button type="text" @click="detail(dataList[item.index])"> è¯¦æƒ… </el-button>
				</template>
				<template v-else>
					<div class="next-page-btn">
						<el-button type="text" :disabled="searchForm.currentPage === totalPage" :loading="nextLoading" @click.stop="loadNextList">
							{{ searchForm.currentPage === totalPage ? 'åŠ è½½å®Œæ¯•' : 'åŠ è½½æ›´å¤š' }}
						</el-button>
					</div>
				</template>
			</div>
		</template>
	</lb-scroll>
</template>
```

<Comments/>